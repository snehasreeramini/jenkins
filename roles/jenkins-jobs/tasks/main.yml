- name:Check Jenkins Connectiom
  shell: "{{JENKINS_CLI_PREFIX}} who-am-i"

- name: Create Jenkins Job
  loop:
    -{name: "sample1", repoName: "sample1"}
  block:
    - name: Check if job exists
      shell: "{{JENKINS_CLI_PREFIX}} get-job {{item.name}}"
      ignore_errors: true
      register: check_job

    - name: Generate UNIQ String for Job
      shell: date |md5sum |awk '{print $1}'
      register: uniq_string

    - name: Update Job Templete
      templete:
        src: job.xml
        dest: /tmp/job.xml

    - name: Create a Job
      when: check_job.rc == 3
      shell: "{{JENKINS_CLI_PREFIX}} create-job {{item.name}}"

#    -name: Update Job
#     when: check_job.rc == 0